<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Merry Christmas</title>
<style>
    html,body{ margin:0; padding:0; width:100%; height:100%; overflow:hidden; background:#000; font-family:cursive; }
    .scene{ position:relative; width:100vw; height:100vh; background:radial-gradient(circle at top,#001b33,#000); overflow:hidden; display:none; } /* åˆå§‹éšè—ï¼Œç‚¹ä¿¡å°åæ˜¾ç¤º */
    
    /* 1. ä¿¡å°å¼€åœºä»ªå¼æ„Ÿ */
    #envelope-wrapper {
        position: fixed; inset: 0; background: #000; z-index: 100;
        display: flex; flex-direction: column; align-items: center; justify-content: center;
        transition: opacity 1.5s ease;
    }
    .envelope { font-size: 80px; cursor: pointer; animation: floating 2s infinite ease-in-out; }
    .envelope-tip { color: #fff; margin-top: 20px; font-size: 18px; letter-spacing: 2px; opacity: 0.8; }
    @keyframes floating { 0%,100% { transform: translateY(0); } 50% { transform: translateY(-20px); } }

    /* 2. æµæ˜ŸèƒŒæ™¯ */
    .star {
        position: absolute; background: white; border-radius: 50%; opacity: 0.3;
    }
    .meteor {
        position: absolute; width: 2px; height: 2px;
        background: linear-gradient(to right, #fff, transparent);
        box-shadow: 0 0 10px #fff; z-index: 2;
        animation: meteor-anim 3s linear infinite;
    }
    @keyframes meteor-anim {
        0% { transform: rotate(-35deg) translateX(0); opacity: 0; }
        10% { opacity: 1; }
        100% { transform: rotate(-35deg) translateX(-1000px); opacity: 0; }
    }

    /* 3. å…¶ä»–å…ƒç´ ä¿æŒå¹¶ä¼˜åŒ– */
    #snowCanvas{ position:absolute; inset:0; z-index:1; pointer-events:none; }
    .mainTree{ position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); font-size:min(60vw,60vh); z-index:3; cursor:pointer; animation:sway 4s ease-in-out infinite; }
    @keyframes sway{ 0%,100%{transform:translate(-50%,-50%) rotate(-1deg);} 50%{transform:translate(-50%,-50%) rotate(1deg);} }
    .bottomText{ position:absolute; bottom:10%; width:100%; text-align:center; color:#fff; z-index:4; text-shadow:0 0 12px rgba(255,255,255,.8); }
    .from{ position:absolute; bottom:2%; right:4%; font-size:14px; color:rgba(255,255,255,0.7); z-index:4; }
    .tip{ position:absolute; padding:10px 16px; background:rgba(255,255,255,.15); border-radius:18px; backdrop-filter:blur(5px); color:#fff; font-size:14px; opacity:0; transition:all 1s ease; z-index:4; pointer-events:none; }
    .tip.show{ opacity:1; transform:translate(-50%,-50%) scale(1.1); }
    .love{ position:fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,.7); z-index:10; opacity:0; pointer-events:none; transition:opacity 0.8s ease; }
    .love.show{ opacity:1; pointer-events:auto; }
    .loveBox{ padding:30px 36px; background:rgba(255,255,255,.15); border-radius:24px; color:#fff; font-size:24px; text-align:center; backdrop-filter:blur(8px); animation:heartbeat 1.6s infinite; }
    @keyframes heartbeat{ 0%,100%{transform:scale(1);} 50%{transform:scale(1.1);} }
    .particle { position: fixed; pointer-events: none; z-index: 99; transition: all 1s ease-out; }
</style>
</head>
<body>

<div id="envelope-wrapper" onclick="openEnvelope()">
    <div class="envelope">âœ‰ï¸</div>
    <div class="envelope-tip">æ¶µå®äº²å¯</div>
</div>

<div class="scene" id="mainScene">
    <canvas id="snowCanvas"></canvas>
    <div class="mainTree" id="tree">ğŸ„</div>
    <div class="bottomText">
        <div style="font-size: 28px;">Merry Christmas</div>
        <div style="font-size: 24px; margin-top: 10px;">æ¶µå®</div>
    </div>
    <div class="from">From TQF</div>
</div>

<div class="love" id="love">
    <div class="loveBox">æ¢è¯—æ¶µ<br>æˆ‘å–œæ¬¢ä½  ğŸ’–</div>
</div>

<audio id="bgm" loop preload="auto">
    <source src="bgm.mp3" type="audio/mpeg">
</audio>

<script>
    const bgm = document.getElementById('bgm');
    const envelope = document.getElementById('envelope-wrapper');
    const scene = document.getElementById('mainScene');
    const tree = document.getElementById('tree');
    const love = document.getElementById('love');

    // 1. å¼€åœºé€»è¾‘ï¼šç‚¹å‡»ä¿¡å°å¯åŠ¨ä¸€åˆ‡
    function openEnvelope() {
        bgm.play();
        envelope.style.opacity = '0';
        setTimeout(() => {
            envelope.style.display = 'none';
            scene.style.display = 'block';
            createStars(); // åˆ›å»ºèƒŒæ™¯è£…é¥°æ˜Ÿ
            startMeteors(); // å¼€å¯æµæ˜Ÿ
        }, 1500);
    }

    // 2. ç‚¹å‡»åœ£è¯æ ‘ï¼šæ’­æ”¾éŸ³ä¹ + è¡¨ç™½ + æ˜Ÿæ˜Ÿç²’å­ç‰¹æ•ˆ
    tree.onclick = (e) => {
        bgm.play(); 
        love.classList.add('show');
        // çˆ†å‘ç²’å­ç‰¹æ•ˆ
        for(let i=0; i<12; i++) {
            createParticle(e.clientX, e.clientY);
        }
        setTimeout(() => love.classList.remove('show'), 4000);
    };

    function createParticle(x, y) {
        const p = document.createElement('div');
        p.className = 'particle';
        p.innerText = ['âœ¨','â­','ğŸŒŸ','â„ï¸'][Math.floor(Math.random()*4)];
        p.style.left = x + 'px';
        p.style.top = y + 'px';
        document.body.appendChild(p);
        const tx = (Math.random() - 0.5) * 300;
        const ty = (Math.random() - 0.5) * 300;
        requestAnimationFrame(() => {
            p.style.transform = `translate(${tx}px, ${ty}px) scale(0) rotate(360deg)`;
            p.style.opacity = '0';
        });
        setTimeout(() => p.remove(), 1000);
    }

    // 3. å”¯ç¾æµæ˜Ÿé€»è¾‘
    function startMeteors() {
        setInterval(() => {
            const m = document.createElement('div');
            m.className = 'meteor';
            m.style.top = Math.random() * 40 + '%';
            m.style.left = '100%';
            scene.appendChild(m);
            setTimeout(() => m.remove(), 3000);
        }, 6000);
    }

    function createStars() {
        for(let i=0; i<50; i++) {
            const s = document.createElement('div');
            s.className = 'star';
            s.style.width = s.style.height = Math.random()*3+'px';
            s.style.left = Math.random()*100+'%';
            s.style.top = Math.random()*60+'%';
            scene.appendChild(s);
        }
    }

    // 4. é›ªèŠ±ç¾åŒ–é€»è¾‘
    const canvas = document.getElementById("snowCanvas");
    const ctx = canvas.getContext("2d");
    function resize() { canvas.width = innerWidth; canvas.height = innerHeight; }
    resize(); window.onresize = resize;

    class Snow {
        constructor() { this.reset(); this.y = Math.random() * canvas.height; }
        reset() {
            this.x = Math.random() * canvas.width;
            this.y = -20;
            this.size = Math.random() * 3 + 2;
            this.speed = Math.random() * 0.8 + 0.5;
            this.velX = (Math.random() - 0.5) * 0.5;
            this.opacity = Math.random() * 0.4 + 0.3;
        }
        update() {
            this.y += this.speed;
            this.x += this.velX;
            if (this.y > canvas.height) this.reset();
        }
        draw() {
            ctx.beginPath();
            const g = ctx.createRadialGradient(this.x, this.y, 0, this.x, this.y, this.size);
            g.addColorStop(0, `rgba(255, 255, 255, ${this.opacity})`);
            g.addColorStop(0.8, `rgba(255, 255, 255, ${this.opacity * 0.3})`);
            g.addColorStop(1, 'rgba(255, 255, 255, 0)');
            ctx.fillStyle = g;
            ctx.arc(this.x, this.y, this.size, 0, Math.PI * 2);
            ctx.fill();
        }
    }
    const snows = Array.from({ length: 100 }, () => new Snow());
    function anim() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        snows.forEach(s => { s.update(); s.draw(); });
        requestAnimationFrame(anim);
    }
    anim();

    // 5. é£˜æµ®è´´å£«
    const tips = ["å¤©å†·å¤šç©¿ç‚¹ â˜ƒï¸", "ä¸å¼€å¿ƒæƒ³æƒ³æˆ‘ ğŸ’—", "æŒ‰æ—¶åƒé¥­ ğŸ°", "å†¬å¤©æˆ‘é™ªä½  âœ¨", "æ‰‹ç»™ä½ æš– ğŸ”¥", "çˆ±ä½  ğŸ’"];
    setInterval(() => {
        if(scene.style.display === 'none') return;
        const tip = document.createElement("div");
        tip.className = "tip";
        tip.innerText = tips[Math.floor(Math.random()*tips.length)];
        scene.appendChild(tip);
        tip.style.left = (Math.random() * 60 + 20) + "%";
        tip.style.top = (Math.random() * 50 + 20) + "%";
        setTimeout(() => tip.classList.add("show"), 100);
        setTimeout(() => { tip.classList.remove("show"); setTimeout(()=>tip.remove(), 1000); }, 3000);
    }, 4500);
</script>
</body>
</html>
